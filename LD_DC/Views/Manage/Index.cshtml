@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta charset="utf-8">
    <title>绿都订餐</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no">
    <!-- 禁止百度转码显示 -->
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <!-- 优先使用 IE 最新版本和 Chrome -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

    <link href="~/Content/muicss/mui.min.css" rel="stylesheet" />
    <link href="~/Content/muicss/mui.picker.min.css" rel="stylesheet" />

    <link href="~/Scripts/muicalendar/libs/swiper.min.css" rel="stylesheet" />
    <link href="~/Scripts/muicalendar/libs/calendar_base.css" rel="stylesheet" />
    <link href="~/Scripts/muicalendar/css/showcase.css" rel="stylesheet" />
    <link href="~/Content/ManageIndex.css" rel="stylesheet" />

    @*<link href="~/Content/muicss/mui.picker.min.css" rel="stylesheet" />
        <script src="~/Scripts/muijs/mui.poppicker.js"></script>*@
    <script src="~/Scripts/muijs/mui.poppicker.js"></script>
 
    <style>
        html,
        body {
            background-color: #ffffff;
        }

        body, .mui-content {
            background-color: #ffffff;
        }

        .mui-bar .mui-pull-left .mui-icon {
            padding-right: 5px;
            font-size: 28px;
        }

        .mui-bar .mui-btn {
            font-weight: normal;
            font-size: 17px;
        }

        .mui-bar .mui-btn-link {
            top: 1px;
        }

        .mui-bar .mui-title {
            background-image: -o-linear-gradient(90deg, rgba(219, 54, 164,1) 0%,rgba(254,220,27,0.5) 100%); /* Opera 11.1 - 12.0 */
            background-image: -moz-linear-gradient(90deg, rgba(219, 54, 164,1) 0%,rgba(254,220,27,0.5) 100%); /* Firefox 3.6 - 15 */
            background-image: -webkit-linear-gradient(90deg, rgba(219, 54, 164,1) 0%,rgba(254,220,27,0.5) 100%); /* Safari 5.1 - 6.0 */
            background-image: -ms-linear-gradient(90deg, rgba(219, 54, 164,1) 0%,rgba(254,220,27,0.5) 100%);
            background-image: linear-gradient(90deg, rgba(219, 54, 164,1) 0%,rgba(254,220,27,0.5) 100%); /* 标准的语法（必须放在最后）*/
            color: white;
        }

        .mui-bar-nav {
            background-color: #dc38a0;
        }

            .mui-bar-nav.mui-bar .mui-icon {
                background-color: #ec885f;
            }

        .mui-table-view .mui-media-object {
            line-height: 42px;
            max-width: 84px;
            height: 42px;
        }

        .mui-btn-block {
            padding-top: 1rem;
            color: rgb(64,64,64);
            font-size: 1.0rem;
            font-weight: bold;
            display: block;
            padding: 0;
        }

        .mui-btn, button, input[type=button], input[type=reset], input[type=submit] {
            border: none;
        }

        /*换行*/
        .mui-ellipsis {
            overflow: hidden;
            white-space: inherit;
            text-overflow: ellipsis;
        }

        .mui-table-view-cell > a:not(.mui-btn) {
            position: relative;
            display: block;
            overflow: hidden;
            margin: -11px -15px;
            padding: inherit;
            white-space: inherit;
            text-overflow: ellipsis;
            color: inherit;
        }
        /*换行 end*/

        
        /*日历*/
        .em-week {
            display: flex;
            justify-content: space-around;
            padding-top: 0px;
            padding-bottom: 10px;
            color: #999999;
            font-size: 13px;
        }

        .mui-input-row .mui-btn {
            line-height: 1.1;
            float: none;
            padding: 10px 15px;
            margin: 2px auto;
            width: 100%;
        }

        .em-journal-title {
            width: 100%;
            display: block;
            height: 50px;
            line-height: 50px;
            background-color: #ffffff;
            /* border-bottom: 0.75px solid rgb(217,217,217); */
        }

        .em-per-block {
            float: left;
            width: 33%;
            color: #6b6b6b;
            font-size: 18px;
        }

        .em-calendar-active {
            background-color: #3C80E6;
            height: 10.285vw;
            width: 10.285vw;
        }


        .em-calendar-content .em-calendar-item {
            float: left;
            width: 14.285vw;
            height: 10.285vw;
            text-align: center;
            /* border: 1px solid #000; */
            border-radius: 10%;
            margin-bottom: 0px;
        }

            .em-calendar-content .em-calendar-item .day {
                display: block;
                padding-top: 0vw;
                font-size: 16px;
                color: #333333;
            }

        .em-calendar-content .isforbid0.em-calendar-item .day {
            display: block;
            padding-top: 0px;
            font-size: 16px;
            color: #D8D8D8;
        }


        /*日历 end*/
    </style>

    <script src="~/Scripts/jquery-1.10.2.min.js"></script>

    <script type="text/javascript">
        //function add_click() {
        //    //var eid = 111;
        //    //$.post("/Supplier/AddFood", { eid: eid }, function (response) {
        //    //    alert(response);
        //    //});
        //    alert("/Supplier/AddFood");
        //    window.location = "/Supplier/AddFood";
        //}


    </script>

</head>
<body>
    <header id="header" class="mui-bar mui-bar-nav ">
        <h1 class="mui-title"><span id="rname">@ViewData["rname"]</span> | <span id="raddress">@ViewData["raddress"]</span></h1>
        <a id="showRPicker" class="mui-icon mui-icon-bars mui-pull-right"></a>
    </header>
    <nav class="mui-bar mui-bar-tab">
        <a class="mui-tab-item" href="javascript:void(0)" style="background-color: #fdd71e" onclick="add_click()">
            <span class="mui-icon mui-icon-home"></span>
            <span class="mui-tab-label">首页</span>
        </a>
        <a id="statistics" class="mui-tab-item" href="javascript:void(0)" style="background-color: #fdd71e">
            <span class="mui-icon mui-icon-compose"></span>
            <span class="mui-tab-label">统计</span>
        </a>
    </nav>
    <div class="mui-content">
        <div class="em-journal-title">
            <div class="em-per-block pre">
                    <span class="mui-icon mui-icon-arrowleft"></span>
                    <span>上一月</span>
                </div>
            <div class="em-per-block mid">
                <span>...</span>
            </div>
            <div class="em-per-block next">
                    <span>下一月</span>
                    <span class="mui-icon mui-icon-arrowright"></span>
                </div>
        </div>
        <!--日历容器-->
        <div id="calendar">
        </div>



        <div class="details">
            <div class="detailsTitle">
                <div id="rectangle">
                    <p class="detailsP">
                        本月订餐情况
                    </p>
                </div>
            </div>
            <div class="detailsInfo">
                <div id="divInfo1">
                    <div class="divZW">全部</div>
                    @{
                        System.Data.DataTable dsThisMonth = (System.Data.DataTable)ViewData["dsThisMonth"];
                        if (dsThisMonth.Rows.Count > 0)
                        {
                            <div class="divYJ">预计 <span style="font-size: 1.0rem;">@dsThisMonth.Rows[0]["yj"].ToString()</span> 人</div>
                            <div class="divSJ">实际 <span style="font-size: 1.0rem;">@dsThisMonth.Rows[0]["sj"].ToString()</span> 人</div>
                        }
                    }
                </div>
            </div>
            <div class="detailsTitle">
                <div id="rectangle">
                    <p class="detailsP">
                        <span>今日</span>订餐情况
                    </p>
                </div>
            </div>
            <div class="detailsInfo">
                <div id="divInfo1">
                    <div class="divZW">中餐</div>
                    @{
                        System.Data.DataTable dsTodayLunch = (System.Data.DataTable)ViewData["dsTodayLunch"];
                        if (dsTodayLunch.Rows.Count > 0)
                        {
                            <div class="divYJ">预计 <span style="font-size: 1.0rem;">@dsTodayLunch.Rows[0]["yj"].ToString()</span> 人</div>
                            <div class="divSJ">实际 <span style="font-size: 1.0rem;">@dsTodayLunch.Rows[0]["sj"].ToString()</span> 人</div>
                        }
                    }
                </div>
            </div>
            <div class="detailsInfo">
                <div id="divInfo1">
                    <div class="divWW">晚餐</div>
                    @{
                        System.Data.DataTable dsTodayDinner = (System.Data.DataTable)ViewData["dsTodayDinner"];
                        if (dsTodayDinner.Rows.Count > 0)
                        {
                            <div class="divYJ">预计 <span style="font-size: 1.0rem;">@dsTodayDinner.Rows[0]["yj"].ToString()</span> 人</div>
                            <div class="divSJ">实际 <span style="font-size: 1.0rem;">@dsTodayDinner.Rows[0]["sj"].ToString()</span> 人</div>
                        }
                    }
                </div>
            </div>
            

        </div>


        @*<div class="backToday">
                返回今天
            </div>*@
        <div id='rGuid' class="ui-alert" style="display:none">@ViewData["restaurantGuid"]</div>
        </div>


        <script src="~/Scripts/muijs/mui.min.js"></script>
        <script src="~/Scripts/muicalendar/libs/swiper.min.js"></script>
        <script src="~/Scripts/muicalendar/libs/mustache.min.js"></script>
        <script src="~/Scripts/muicalendar/libs/calendar_base.js"></script>
        <script src="~/Scripts/muijs/mui.picker.min.js"></script>
        @*<script src="~/Scripts/muijs/mui.poppicker.js"></script>*@
        @*<script src="~/Scripts/muicalendar/js/calendar_showcase.js"></script>*@

        <script type="text/javascript">
            mui.init({

            });

            (function ($, doc) {
   
                $.ready(function () {
                    $.post("/Manage/GetRJson", {}, function (response) {
                        //alert(response);
                        var _getParam = function (obj, param) {
                            return obj[param] || '';
                        };
                        var RPicker = new $.PopPicker();
                        RPicker.setData(eval(response));
                        //userPicker.setData([{ value: '1', text: '热菜' }, { value: '2', text: '凉菜' }, { value: '3', text: '汤羹' }, { value: '4', text: '主食' }, { value: '5', text: '小吃' }, { value: '6', text: '饮品' }, { value: '7', text: '西餐' }, { value: '8', text: '烘焙' }, { value: '9', text: '火锅' }, { value: '10', text: '海鲜' }]);
                        var showRPickerButton = doc.getElementById('showRPicker');
                        var name = doc.getElementById('rname');
                        //var userResult = doc.getElementById('vtResult');
                        var vtRID = doc.getElementById('rGuid');
                        //var rcity = doc.getElementById('rcity');
                        var raddress = doc.getElementById('raddress');
                        showRPickerButton.addEventListener('tap', function (event) {
                            RPicker.show(function (items) {
                                //userResult.innerText = JSON.stringify(items[0]["text"]).replace(/"/g, "");
                                vtRID.innerText = JSON.stringify(items[0]["value"]).replace(/"/g, "");
                                name.innerText = JSON.stringify(items[0]["text"]).replace(/"/g, "");
                                //rcity.innerText = JSON.stringify(items[0]["F1"]).replace(/"/g, "") + JSON.stringify(items[0]["F2"]).replace(/"/g, "");
                                raddress.innerText = JSON.stringify(items[0]["F3"]).replace(/"/g, "");
                                //userResult.innerText = JSON.stringify(items[0]);
                                //返回 false 可以阻止选择框的关闭
                                //return false;
                                var rid = JSON.stringify(items[0]["value"]).replace(/"/g, "");
                                $.post("/Manage/ReloadPage", { rid: rid }, function (response) {
                                    //alert(response);
                                    //var container = document.querySelector('.contentDiv');
                                    //container.innerHTML = response;
                                    window.location = "/Manage/Index";
                                });


                            });
                        }, false);
                    });
                });
            })(mui, document);

            var customBiz = {
                init: function () {
                    var self = this;
                    // 初始化日历

                    var calendar = new Calendar({
                        // swiper滑动容器
                        container: "#calendar",
                        // 上一月节点
                        pre: ".pre",
                        // 下一月节点
                        next: ".next",
                        // 回到今天
                        backToToday: ".backToday",
                        // 业务数据改变
                        dataRequest: function (currdate, callback, _this) {
                            // 无日程安排
                            var data = [{
                                "date": "2018-04-18"
                            }, {
                                "date": "2018-04-17"
                            }, {
                                "date": "2018-04-16"
                            }];
                            callback && callback(data);
                        },
                        // 点击日期事件
                        onItemClick: function (item) {
                            var defaultDate = item.date;
                            // 设置标题
                            setTitle(defaultDate);
                            var rGuid = document.getElementById('rGuid').innerText; 

                            $.post("/Manage/UpdateHtml", { defaultDate: defaultDate, rGuid: rGuid }, function (response) {
                                //alert(response);
                                $(".details").html(response);
                            });

                            
                        },
                        // 滑动回调
                        swipeCallback: function (item) {
                            var defaultDate = item.date;
                            // 设置标题
                            setTitle(defaultDate);
                            var rGuid = document.getElementById('rGuid').innerText;

                            $.post("/Manage/UpdateHtml", { defaultDate: defaultDate, rGuid: rGuid }, function (response) {
                                //alert(response);
                                $(".details").html(response);
                            });
                        },
                        // 调试
                        isDebug: false
                    });
                    // 设置标题
                    var titleNode = document.querySelector('.mid span');
                    //var dateSpan = document.querySelector('.detailsP span');
                    function setTitle(date) {
                        titleNode.innerText = date;
                        //alert(dateSpan.innerText);
                        //dateSpan.innerText = date;
                    }

                }
            }

            // 初始化
            customBiz.init();

            document.getElementById("statistics").addEventListener("tap", function () {
                var rGuid = document.getElementById('rGuid').innerText;
                window.location = "/Manage/Statistics?rGuid=" + rGuid;
            });
       
        </script>
</body>
</html>
